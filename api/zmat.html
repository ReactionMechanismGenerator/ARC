

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>arc.species.zmat &mdash; ARC 1.1.0 Documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=fc837d61"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="arc.reaction" href="reaction.html" />
    <link rel="prev" title="arc.species.vectors" href="vectors.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            ARC
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../running.html">Running ARC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced.html">Advanced Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../output.html">Output</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">ARC’s API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="main.html">arc.main</a></li>
<li class="toctree-l2"><a class="reference internal" href="species.html">arc.species.species</a></li>
<li class="toctree-l2"><a class="reference internal" href="converter.html">arc.species.converter</a></li>
<li class="toctree-l2"><a class="reference internal" href="conformers.html">arc.species.conformers</a></li>
<li class="toctree-l2"><a class="reference internal" href="vectors.html">arc.species.vectors</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">arc.species.zmat</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#arc.species.zmat.add_dummy_atom"><code class="docutils literal notranslate"><span class="pre">add_dummy_atom()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#arc.species.zmat.check_atom_a_constraints"><code class="docutils literal notranslate"><span class="pre">check_atom_a_constraints()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#arc.species.zmat.check_atom_d_constraints"><code class="docutils literal notranslate"><span class="pre">check_atom_d_constraints()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#arc.species.zmat.check_atom_r_constraints"><code class="docutils literal notranslate"><span class="pre">check_atom_r_constraints()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#arc.species.zmat.consolidate_zmat"><code class="docutils literal notranslate"><span class="pre">consolidate_zmat()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#arc.species.zmat.determine_a_atoms"><code class="docutils literal notranslate"><span class="pre">determine_a_atoms()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#arc.species.zmat.determine_d_atoms"><code class="docutils literal notranslate"><span class="pre">determine_d_atoms()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#arc.species.zmat.determine_d_atoms_from_connectivity"><code class="docutils literal notranslate"><span class="pre">determine_d_atoms_from_connectivity()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#arc.species.zmat.determine_d_atoms_without_connectivity"><code class="docutils literal notranslate"><span class="pre">determine_d_atoms_without_connectivity()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#arc.species.zmat.determine_r_atoms"><code class="docutils literal notranslate"><span class="pre">determine_r_atoms()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#arc.species.zmat.drop_symbol_and_coords_row_0"><code class="docutils literal notranslate"><span class="pre">drop_symbol_and_coords_row_0()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#arc.species.zmat.get_all_neighbors"><code class="docutils literal notranslate"><span class="pre">get_all_neighbors()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#arc.species.zmat.get_atom_connectivity_from_mol"><code class="docutils literal notranslate"><span class="pre">get_atom_connectivity_from_mol()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#arc.species.zmat.get_atom_indices_from_zmat_parameter"><code class="docutils literal notranslate"><span class="pre">get_atom_indices_from_zmat_parameter()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#arc.species.zmat.get_atom_order"><code class="docutils literal notranslate"><span class="pre">get_atom_order()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#arc.species.zmat.get_atom_order_from_mol"><code class="docutils literal notranslate"><span class="pre">get_atom_order_from_mol()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#arc.species.zmat.get_atom_order_from_xyz"><code class="docutils literal notranslate"><span class="pre">get_atom_order_from_xyz()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#arc.species.zmat.get_connectivity"><code class="docutils literal notranslate"><span class="pre">get_connectivity()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#arc.species.zmat.get_parameter_from_atom_indices"><code class="docutils literal notranslate"><span class="pre">get_parameter_from_atom_indices()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#arc.species.zmat.is_atom_in_linear_angle"><code class="docutils literal notranslate"><span class="pre">is_atom_in_linear_angle()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#arc.species.zmat.is_atom_in_new_fragment"><code class="docutils literal notranslate"><span class="pre">is_atom_in_new_fragment()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#arc.species.zmat.is_dummy"><code class="docutils literal notranslate"><span class="pre">is_dummy()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#arc.species.zmat.map_index_to_int"><code class="docutils literal notranslate"><span class="pre">map_index_to_int()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#arc.species.zmat.order_fragments_by_constraints"><code class="docutils literal notranslate"><span class="pre">order_fragments_by_constraints()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#arc.species.zmat.purge_references_to_atom_0"><code class="docutils literal notranslate"><span class="pre">purge_references_to_atom_0()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#arc.species.zmat.rebuild_map"><code class="docutils literal notranslate"><span class="pre">rebuild_map()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#arc.species.zmat.remove_zmat_atom_0"><code class="docutils literal notranslate"><span class="pre">remove_zmat_atom_0()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#arc.species.zmat.renumber_params"><code class="docutils literal notranslate"><span class="pre">renumber_params()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#arc.species.zmat.up_param"><code class="docutils literal notranslate"><span class="pre">up_param()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#arc.species.zmat.update_zmat_with_new_atom"><code class="docutils literal notranslate"><span class="pre">update_zmat_with_new_atom()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#arc.species.zmat.xyz_to_zmat"><code class="docutils literal notranslate"><span class="pre">xyz_to_zmat()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#arc.species.zmat.zmat_to_coords"><code class="docutils literal notranslate"><span class="pre">zmat_to_coords()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="reaction.html">arc.reaction</a></li>
<li class="toctree-l2"><a class="reference internal" href="scheduler.html">arc.scheduler</a></li>
<li class="toctree-l2"><a class="reference internal" href="job.html">arc.job</a></li>
<li class="toctree-l2"><a class="reference internal" href="ssh.html">arc.job.ssh</a></li>
<li class="toctree-l2"><a class="reference internal" href="local.html">arc.job.local</a></li>
<li class="toctree-l2"><a class="reference internal" href="trsh.html">arc.job.trsh</a></li>
<li class="toctree-l2"><a class="reference internal" href="parser.html">arc.parser</a></li>
<li class="toctree-l2"><a class="reference internal" href="plotter.html">arc.plotter</a></li>
<li class="toctree-l2"><a class="reference internal" href="processor.html">arc.processor</a></li>
<li class="toctree-l2"><a class="reference internal" href="rmgdb.html">arc.rmgdb</a></li>
<li class="toctree-l2"><a class="reference internal" href="common.html">arc.common</a></li>
<li class="toctree-l2"><a class="reference internal" href="level.html">arc.level</a></li>
<li class="toctree-l2"><a class="reference internal" href="scale.html">arc.utils.scale</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tools.html">Standalone tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../media.html">Media</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribute.html">Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cite.html">How to cite ARC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../licence.html">Licence</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ARC</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">ARC’s API</a></li>
      <li class="breadcrumb-item active">arc.species.zmat</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/zmat.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-arc.species.zmat">
<span id="arc-species-zmat"></span><span id="zmat"></span><h1>arc.species.zmat<a class="headerlink" href="#module-arc.species.zmat" title="Link to this heading"></a></h1>
<p>A module for representing and manipulating <a class="reference external" href="https://en.wikipedia.org/wiki/Z-matrix_(chemistry)">Z matrices</a>
(internal coordinates).</p>
<p>An example for a (consolidated) zmat representation for methane:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;symbols&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">),</span>
 <span class="s1">&#39;coords&#39;</span><span class="p">:</span> <span class="p">((</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;R_1_0&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;R_2|3|4_1|2|3&#39;</span><span class="p">,</span> <span class="s1">&#39;A_2|3|4_1|2|3_0|0|0&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;R_2|3|4_1|2|3&#39;</span><span class="p">,</span> <span class="s1">&#39;A_2|3|4_1|2|3_0|0|0&#39;</span><span class="p">,</span> <span class="s1">&#39;D_3_2_0_1&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;R_2|3|4_1|2|3&#39;</span><span class="p">,</span> <span class="s1">&#39;A_2|3|4_1|2|3_0|0|0&#39;</span><span class="p">,</span> <span class="s1">&#39;D_4_3_0_2&#39;</span><span class="p">)),</span>
 <span class="s1">&#39;vars&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;R_1_0&#39;</span><span class="p">:</span> <span class="mf">1.09125</span><span class="p">,</span>
          <span class="s1">&#39;D_3_2_0_1&#39;</span><span class="p">:</span> <span class="mf">120.0</span><span class="p">,</span>
          <span class="s1">&#39;D_4_3_0_2&#39;</span><span class="p">:</span> <span class="mf">240.0</span><span class="p">,</span>
          <span class="s1">&#39;R_2|3|4_1|2|3&#39;</span><span class="p">:</span> <span class="mf">1.78200</span><span class="p">,</span>
          <span class="s1">&#39;A_2|3|4_1|2|3_0|0|0&#39;</span><span class="p">:</span> <span class="mf">35.26439</span><span class="p">},</span>
 <span class="s1">&#39;map&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span>
 <span class="p">}</span>
</pre></div>
</div>
<p>Isotope information is not saved in the zmat, it exists in the xyz dict,
and can be attained using the zmat map if needed.</p>
<p>Note that a 180 (or 0) degree for an angle in a Z matrix is not allowed, since a GIC (Generalized Internal Coordinates)
optimization has no defined derivative at 180 degrees. Instead, a dummy atom ‘X’ is used.
Dihedral angles may have any value.</p>
<dl class="py function">
<dt class="sig sig-object py" id="arc.species.zmat.add_dummy_atom">
<span class="sig-prename descclassname"><span class="pre">arc.species.zmat.</span></span><span class="sig-name descname"><span class="pre">add_dummy_atom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zmat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xyz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connectivity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/arc/species/zmat.html#add_dummy_atom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#arc.species.zmat.add_dummy_atom" title="Link to this definition"></a></dt>
<dd><p>Add a dummy atom ‘X’ to the zmat.
Also updates the r_atoms and a_atoms lists for the original (non-dummy) atom.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>zmat</strong> (<em>dict</em>) – The zmat.</p></li>
<li><p><strong>xyz</strong> (<em>dict</em>) – The xyz dict.</p></li>
<li><p><strong>coords</strong> (<em>Union</em><em>[</em><em>list</em><em>, </em><em>tuple</em><em>]</em>) – Just the ‘coords’ part of the xyz dict.</p></li>
<li><p><strong>connectivity</strong> (<em>dict</em>) – The atoms connectivity (keys are indices in the mol/xyz).</p></li>
<li><p><strong>r_atoms</strong> (<em>list</em>) – The determined r_atoms.</p></li>
<li><p><strong>a_atoms</strong> (<em>list</em>) – The determined a_atoms.</p></li>
<li><p><strong>n</strong> (<em>int</em>) – The 0-index of the atom in the zmat to be added.</p></li>
<li><p><strong>atom_index</strong> (<em>int</em>) – The 0-index of the atom in the molecule or cartesian coordinates to be added.
(<code class="docutils literal notranslate"><span class="pre">n</span></code> and <code class="docutils literal notranslate"><span class="pre">atom_index</span></code> refer to the same atom, but it might have different indices
in the zmat and the molecule/xyz)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>The zmat.</p></li>
<li><p>The coordinates (list of tuples).</p></li>
<li><p>The updated atom index in the zmat.</p></li>
<li><p>The R atom indices.</p></li>
<li><p>The A atom indices.</p></li>
<li><p>A specific atom index to be used as the last entry of the D atom indices.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[dict, list, int, list, list, int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="arc.species.zmat.check_atom_a_constraints">
<span class="sig-prename descclassname"><span class="pre">arc.species.zmat.</span></span><span class="sig-name descname"><span class="pre">check_atom_a_constraints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/arc/species/zmat.html#check_atom_a_constraints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#arc.species.zmat.check_atom_a_constraints" title="Link to this definition"></a></dt>
<dd><p>Check angle constraints for an atom.
‘A’ constraints are a list of tuples with length 3.
The first atom in an A constraint is considered “constraint” for zmat generation:
its angle will be relative to the second and third atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom_index</strong> (<em>int</em>) – The 0-indexed atom index to check.</p></li>
<li><p><strong>constraints</strong> (<em>dict</em>) – The ‘R’, ‘A’, ‘D’ constraints dict. Values are lists of constraints.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ZMatError</strong> – If the A constraint lengths do not equal three, or if the atom is constrained more than once.</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>The atom indices to which the atom being checked is constrained. <code class="docutils literal notranslate"><span class="pre">None</span></code> if it is not constrained.</p></li>
<li><p>The constraint type (‘A_atom’, or ‘A_group’). <code class="docutils literal notranslate"><span class="pre">None</span></code> if it is not constrained.</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple[Optional[tuple], Optional[str]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="arc.species.zmat.check_atom_d_constraints">
<span class="sig-prename descclassname"><span class="pre">arc.species.zmat.</span></span><span class="sig-name descname"><span class="pre">check_atom_d_constraints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/arc/species/zmat.html#check_atom_d_constraints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#arc.species.zmat.check_atom_d_constraints" title="Link to this definition"></a></dt>
<dd><p>Check dihedral angle constraints for an atom.
‘D’ constraints are a list of tuples with length 4.
The first atom in a D constraint is considered “constraint” for zmat generation:
its dihedral angle will be relative to the second, third, and forth atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom_index</strong> (<em>int</em>) – The 0-indexed atom index to check.</p></li>
<li><p><strong>constraints</strong> (<em>dict</em>) – The ‘R’, ‘A’, ‘D’ constraints dict. Values are lists of constraints.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ZMatError</strong> – If the A constraint lengths do not equal three, or if the atom is constrained more than once.</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>The atom indices to which the atom being checked is constrained. <code class="docutils literal notranslate"><span class="pre">None</span></code> if it is not constrained.</p></li>
<li><p>The constraint type (‘D_atom’, ‘D_group’).</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple[Optional[tuple], Optional[str]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="arc.species.zmat.check_atom_r_constraints">
<span class="sig-prename descclassname"><span class="pre">arc.species.zmat.</span></span><span class="sig-name descname"><span class="pre">check_atom_r_constraints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/arc/species/zmat.html#check_atom_r_constraints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#arc.species.zmat.check_atom_r_constraints" title="Link to this definition"></a></dt>
<dd><p>Check distance constraints for an atom.
‘R’ constraints are a list of tuples with length 2.
The first atom in an R constraint is considered “constraint” for zmat generation:
its distance will be relative to the second atom.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom_index</strong> (<em>int</em>) – The 0-indexed atom index to check.</p></li>
<li><p><strong>constraints</strong> (<em>dict</em>) – The ‘R’, ‘A’, ‘D’ constraints dict. Values are lists of constraints.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ZMatError</strong> – If the R constraint lengths do not equal two, or if the atom is constrained more than once.</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>The atom index to which the atom being checked is constrained. <code class="docutils literal notranslate"><span class="pre">None</span></code> if it is not constrained.</p></li>
<li><p>The constraint type (‘R_atom’, or ‘R_group’).</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple[Optional[tuple], Optional[str]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="arc.species.zmat.consolidate_zmat">
<span class="sig-prename descclassname"><span class="pre">arc.species.zmat.</span></span><span class="sig-name descname"><span class="pre">consolidate_zmat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zmat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Molecule</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">consolidation_tols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/arc/species/zmat.html#consolidate_zmat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#arc.species.zmat.consolidate_zmat" title="Link to this definition"></a></dt>
<dd><p>Consolidate (almost) identical vars in the zmat.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>zmat</strong> (<em>dict</em>) – The zmat.</p></li>
<li><p><strong>mol</strong> (<em>Molecule</em><em>, </em><em>optional</em>) – The RMG molecule, used for atom types if not None,
otherwise atom symbols from the zmat are used.</p></li>
<li><p><strong>consolidation_tols</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keys are ‘R’, ‘A’, ‘D’, values are floats representing absolute tolerance
for consolidating almost equal internal coordinates.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The consolidated zmat.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="arc.species.zmat.determine_a_atoms">
<span class="sig-prename descclassname"><span class="pre">arc.species.zmat.</span></span><span class="sig-name descname"><span class="pre">determine_a_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zmat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connectivity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_constraint</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_constraint</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_constraint_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trivial_assignment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/arc/species/zmat.html#determine_a_atoms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#arc.species.zmat.determine_a_atoms" title="Link to this definition"></a></dt>
<dd><p>Determine the atoms for defining the angle A.
This should be in the form: [n, r_atoms[1], &lt;some other atom already in the zmat&gt;]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>zmat</strong> (<em>dict</em>) – The zmat.</p></li>
<li><p><strong>coords</strong> (<em>list</em><em>, </em><em>tuple</em>) – Just the ‘coords’ part of the xyz dict.</p></li>
<li><p><strong>connectivity</strong> (<em>dict</em>) – The atoms connectivity (keys are indices in the mol/xyz).</p></li>
<li><p><strong>r_atoms</strong> (<em>list</em>) – The determined r_atoms.</p></li>
<li><p><strong>n</strong> (<em>int</em>) – The 0-index of the atom in the zmat to be added.</p></li>
<li><p><strong>atom_index</strong> (<em>int</em>) – The 0-index of the atom in the molecule or cartesian coordinates to be added.
(<code class="docutils literal notranslate"><span class="pre">n</span></code> and <code class="docutils literal notranslate"><span class="pre">atom_index</span></code> refer to the same atom, but it might have different indices
in the zmat and the molecule/xyz)</p></li>
<li><p><strong>a_constraint</strong> (<em>tuple</em><em>, </em><em>optional</em>) – A-type constraints. The atom indices to which the atom being checked is
constrained. <code class="docutils literal notranslate"><span class="pre">None</span></code> if it is not constrained.</p></li>
<li><p><strong>d_constraint</strong> (<em>tuple</em><em>, </em><em>optional</em>) – D-type constraints. The atom indices to which the atom being checked is
constrained. <code class="docutils literal notranslate"><span class="pre">None</span></code> if it is not constrained.</p></li>
<li><p><strong>a_constraint_type</strong> (<em>str</em><em>, </em><em>optional</em>) – The A constraint type (‘A_atom’, or ‘A_group’).</p></li>
<li><p><strong>trivial_assignment</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to attempt assigning atoms without considering connectivity
if the connectivity assignment fails.</p></li>
<li><p><strong>fragments</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Fragments represented by the species, i.e., as in a VdW well or a TS.
Entries are atom index lists of all atoms in a fragment, each list represents a different fragment.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ZMatError</strong> – If the A atoms could not be determined.
    indices are 0-indexed.</p>
</dd>
</dl>
<dl class="simple">
<dt>Returns: Optional[List[int]]</dt><dd><p>The 0-indexed z-mat A atoms.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="arc.species.zmat.determine_d_atoms">
<span class="sig-prename descclassname"><span class="pre">arc.species.zmat.</span></span><span class="sig-name descname"><span class="pre">determine_d_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zmat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xyz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connectivity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_constraint</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_constraint_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">specific_atom</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dummy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/arc/species/zmat.html#determine_d_atoms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#arc.species.zmat.determine_d_atoms" title="Link to this definition"></a></dt>
<dd><p>Determine the atoms for defining the dihedral angle D.
This should be in the form: [n, a_atoms[1], a_atoms[2], &lt;some other atom already in the zmat&gt;]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>zmat</strong> (<em>dict</em>) – The zmat.</p></li>
<li><p><strong>xyz</strong> (<em>dict</em>) – The xyz dict.</p></li>
<li><p><strong>coords</strong> (<em>list</em><em>, </em><em>tuple</em>) – Just the ‘coords’ part of the xyz dict.</p></li>
<li><p><strong>connectivity</strong> (<em>dict</em>) – The atoms connectivity (keys are indices in the mol/xyz).</p></li>
<li><p><strong>a_atoms</strong> (<em>list</em>) – The determined a_atoms.</p></li>
<li><p><strong>n</strong> (<em>int</em>) – The 0-index of the atom in the zmat to be added.</p></li>
<li><p><strong>atom_index</strong> (<em>int</em>) – The 0-index of the atom in the molecule or cartesian coordinates to be added.
(<code class="docutils literal notranslate"><span class="pre">n</span></code> and <code class="docutils literal notranslate"><span class="pre">atom_index</span></code> refer to the same atom, but it might have different indices
in the zmat and the molecule/xyz)</p></li>
<li><p><strong>d_constraint</strong> (<em>tuple</em><em>, </em><em>optional</em>) – D-type constraints. The atom indices to which the atom being checked is
constrained. <code class="docutils literal notranslate"><span class="pre">None</span></code> if it is not constrained.</p></li>
<li><p><strong>d_constraint_type</strong> (<em>str</em><em>, </em><em>optional</em>) – The D constraint type (‘D_atom’, or ‘D_group’).</p></li>
<li><p><strong>specific_atom</strong> (<em>int</em><em>, </em><em>optional</em>) – A 0-index of the zmat atom to be added to a_atoms to create d_atoms.</p></li>
<li><p><strong>dummy</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the atom being added (n) represents a dummy atom. <code class="docutils literal notranslate"><span class="pre">True</span></code> if it does.</p></li>
<li><p><strong>fragments</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Fragments represented by the species, i.e., as in a VdW well or a TS.
Entries are atom index lists of all atoms in a fragment, each list represents a different fragment.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ZMatError</strong> – If the A atoms could not be determined.
    indices are 0-indexed.</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The 0-indexed z-mat D atoms.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Optional[List[int]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="arc.species.zmat.determine_d_atoms_from_connectivity">
<span class="sig-prename descclassname"><span class="pre">arc.species.zmat.</span></span><span class="sig-name descname"><span class="pre">determine_d_atoms_from_connectivity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zmat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xyz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connectivity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dummy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_a_to_be_dummy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="../_modules/arc/species/zmat.html#determine_d_atoms_from_connectivity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#arc.species.zmat.determine_d_atoms_from_connectivity" title="Link to this definition"></a></dt>
<dd><p>A helper function to determine d_atoms from the connectivity information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>zmat</strong> (<em>dict</em>) – The zmat.</p></li>
<li><p><strong>xyz</strong> (<em>dict</em>) – The xyz dict.</p></li>
<li><p><strong>coords</strong> (<em>Union</em><em>[</em><em>list</em><em>, </em><em>tuple</em><em>]</em>) – Just the ‘coords’ part of the xyz dict.</p></li>
<li><p><strong>connectivity</strong> (<em>dict</em>) – The atoms connectivity (keys are indices in the mol/xyz).</p></li>
<li><p><strong>a_atoms</strong> (<em>list</em>) – The determined a_atoms.</p></li>
<li><p><strong>atom_index</strong> (<em>int</em>) – The 0-index of the atom in the molecule or cartesian coordinates to be added.
(<code class="docutils literal notranslate"><span class="pre">n</span></code> and <code class="docutils literal notranslate"><span class="pre">atom_index</span></code> refer to the same atom, but it might have different indices
in the zmat and the molecule/xyz)</p></li>
<li><p><strong>dummy</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the atom being added (n) represents a dummy atom. <code class="docutils literal notranslate"><span class="pre">True</span></code> if it does.</p></li>
<li><p><strong>allow_a_to_be_dummy</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the last atom (‘A’) in d_atoms is allowed to by a dummy atom.
<code class="docutils literal notranslate"><span class="pre">True</span></code> if it is, <code class="docutils literal notranslate"><span class="pre">False</span></code> by default.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The d_atoms.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="arc.species.zmat.determine_d_atoms_without_connectivity">
<span class="sig-prename descclassname"><span class="pre">arc.species.zmat.</span></span><span class="sig-name descname"><span class="pre">determine_d_atoms_without_connectivity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zmat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="../_modules/arc/species/zmat.html#determine_d_atoms_without_connectivity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#arc.species.zmat.determine_d_atoms_without_connectivity" title="Link to this definition"></a></dt>
<dd><p>A helper function to determine d_atoms without connectivity information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>zmat</strong> (<em>dict</em>) – The zmat.</p></li>
<li><p><strong>coords</strong> (<em>Union</em><em>[</em><em>list</em><em>, </em><em>tuple</em><em>]</em>) – Just the ‘coords’ part of the xyz dict.</p></li>
<li><p><strong>a_atoms</strong> (<em>list</em>) – The determined a_atoms.</p></li>
<li><p><strong>n</strong> (<em>int</em>) – The 0-index of the atom in the zmat to be added.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The d_atoms.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="arc.species.zmat.determine_r_atoms">
<span class="sig-prename descclassname"><span class="pre">arc.species.zmat.</span></span><span class="sig-name descname"><span class="pre">determine_r_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zmat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xyz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connectivity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_constraint</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_constraint</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_constraint</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trivial_assignment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/arc/species/zmat.html#determine_r_atoms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#arc.species.zmat.determine_r_atoms" title="Link to this definition"></a></dt>
<dd><p>Determine the atoms for defining the distance R.
This should be in the form: [n, &lt;some other atom already in the zmat&gt;]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>zmat</strong> (<em>dict</em>) – The zmat.</p></li>
<li><p><strong>xyz</strong> (<em>dict</em>) – The xyz dict.</p></li>
<li><p><strong>connectivity</strong> (<em>dict</em>) – The atoms connectivity (keys are indices in the mol/xyz).</p></li>
<li><p><strong>n</strong> (<em>int</em>) – The 0-index of the atom in the zmat to be added.</p></li>
<li><p><strong>atom_index</strong> (<em>int</em>) – The 0-index of the atom in the molecule or cartesian coordinates to be added.
(<code class="docutils literal notranslate"><span class="pre">n</span></code> and <code class="docutils literal notranslate"><span class="pre">atom_index</span></code> refer to the same atom, but it might have different indices
in the zmat and the molecule/xyz)</p></li>
<li><p><strong>r_constraint</strong> (<em>tuple</em><em>, </em><em>optional</em>) – R-type constraints. The atom index to which the atom being checked is
constrained. <code class="docutils literal notranslate"><span class="pre">None</span></code> if it is not constrained.</p></li>
<li><p><strong>a_constraint</strong> (<em>tuple</em><em>, </em><em>optional</em>) – A-type constraints. The atom indices to which the atom being checked is
constrained. <code class="docutils literal notranslate"><span class="pre">None</span></code> if it is not constrained.</p></li>
<li><p><strong>d_constraint</strong> (<em>tuple</em><em>, </em><em>optional</em>) – D-type constraints. The atom indices to which the atom being checked is
constrained. <code class="docutils literal notranslate"><span class="pre">None</span></code> if it is not constrained.</p></li>
<li><p><strong>trivial_assignment</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to attempt assigning atoms without considering connectivity
if the connectivity assignment fails.</p></li>
<li><p><strong>fragments</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Fragments represented by the species, i.e., as in a VdW well or a TS.
Entries are atom index lists of all atoms in a fragment, each list represents a different fragment.
indices are 0-indexed.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ZMatError</strong> – If the R atoms could not be determined.</p>
</dd>
</dl>
<dl class="simple">
<dt>Returns: Optional[List[int]]</dt><dd><p>The 0-indexed z-mat R atoms.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="arc.species.zmat.drop_symbol_and_coords_row_0">
<span class="sig-prename descclassname"><span class="pre">arc.species.zmat.</span></span><span class="sig-name descname"><span class="pre">drop_symbol_and_coords_row_0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zmat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/arc/species/zmat.html#drop_symbol_and_coords_row_0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#arc.species.zmat.drop_symbol_and_coords_row_0" title="Link to this definition"></a></dt>
<dd><p>Remove the 0th atom from the Z-matrix:
- Removes the first symbol and coordinate row
- Clears DOFs for the new atoms 0–2 (Z-matrix rules)
- Removes unused variables from <cite>vars</cite>
- Leaves map untouched (to be rebuilt later)
- Does NOT decrement atom indices; that’s handled later</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="arc.species.zmat.get_all_neighbors">
<span class="sig-prename descclassname"><span class="pre">arc.species.zmat.</span></span><span class="sig-name descname"><span class="pre">get_all_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/arc/species/zmat.html#get_all_neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#arc.species.zmat.get_all_neighbors" title="Link to this definition"></a></dt>
<dd><p>Get atom indices of all neighbors of an atom in a molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>Molecule</em>) – The RMG molecule with connectivity information.</p></li>
<li><p><strong>atom_index</strong> (<em>int</em>) – The index of the atom whose neighbors are requested.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Atom indices of all neighbors of the requested atom.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="arc.species.zmat.get_atom_connectivity_from_mol">
<span class="sig-prename descclassname"><span class="pre">arc.species.zmat.</span></span><span class="sig-name descname"><span class="pre">get_atom_connectivity_from_mol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Atom</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/arc/species/zmat.html#get_atom_connectivity_from_mol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#arc.species.zmat.get_atom_connectivity_from_mol" title="Link to this definition"></a></dt>
<dd><p>Get the connectivity of <code class="docutils literal notranslate"><span class="pre">atom</span></code> in <code class="docutils literal notranslate"><span class="pre">mol</span></code>.
Returns heavy (non-H) atoms first.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>Molecule</em>) – The molecule with connectivity information.</p></li>
<li><p><strong>atom1</strong> (<em>Atom</em>) – The atom to check connectivity for.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>0-indices of atoms in <code class="docutils literal notranslate"><span class="pre">mol</span></code> connected to <code class="docutils literal notranslate"><span class="pre">atom</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="arc.species.zmat.get_atom_indices_from_zmat_parameter">
<span class="sig-prename descclassname"><span class="pre">arc.species.zmat.</span></span><span class="sig-name descname"><span class="pre">get_atom_indices_from_zmat_parameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="reference internal" href="../_modules/arc/species/zmat.html#get_atom_indices_from_zmat_parameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#arc.species.zmat.get_atom_indices_from_zmat_parameter" title="Link to this definition"></a></dt>
<dd><p>Get the atom indices from a zmat parameter.</p>
<p class="rubric">Examples</p>
<p>‘R_0_2’ –&gt; ((0, 2),)
‘A_0_1_2’ –&gt; ((0, 1, 2),) corresponding to angle 0-1-2
‘D_0_1_2_4’ –&gt; ((0, 1, 2, 4),)
‘R_0|0_3|4’ –&gt; ((0, 3), (0, 4))
‘A_0|0|0_1|1|1_2|3|4’ –&gt; ((0, 1, 2), (0, 1, 3), (0, 1, 4)) corresponding to angles 0-1-2, 0-1-3, and 0-1-4
‘D_0|0|0_1|1|1_2|3|4_5|6|9’ –&gt; ((0, 1, 2, 5), (0, 1, 3, 6), (0, 1, 4, 9))
‘RX_0_2’ –&gt; ((0, 2),)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>param</strong> (<em>str</em>) – The zmat parameter.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Entries are tuples of indices, each describing R, A, or D parameters.</dt><dd><p>The tuple entries for R, A, and D types are of lengths 2, 3, and 4, respectively.
The number of tuple entries depends on the number of consolidated parameters.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="arc.species.zmat.get_atom_order">
<span class="sig-prename descclassname"><span class="pre">arc.species.zmat.</span></span><span class="sig-name descname"><span class="pre">get_atom_order</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xyz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Molecule</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraints_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/arc/species/zmat.html#get_atom_order"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#arc.species.zmat.get_atom_order" title="Link to this definition"></a></dt>
<dd><p>Get the order in which atoms should be added to the zmat from a 2D or a 3D representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xyz</strong> (<em>dict</em><em>, </em><em>optional</em>) – The 3D coordinates.</p></li>
<li><p><strong>mol</strong> (<em>Molecule</em><em>, </em><em>optional</em>) – The Molecule object.</p></li>
<li><p><strong>fragments</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Fragments represented by the species, i.e., as in a VdW well or a TS.
Entries are atom index lists of all atoms in a fragment, each list represents a different fragment.</p></li>
<li><p><strong>constraints_dict</strong> (<em>dict</em><em>, </em><em>optional</em>) – A dictionary of atom constraints. The function will try to find an atom order in which all constrained atoms
are after the atoms they are constraint to.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The atom order, 0-indexed.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="arc.species.zmat.get_atom_order_from_mol">
<span class="sig-prename descclassname"><span class="pre">arc.species.zmat.</span></span><span class="sig-name descname"><span class="pre">get_atom_order_from_mol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraints_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xyz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/arc/species/zmat.html#get_atom_order_from_mol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#arc.species.zmat.get_atom_order_from_mol" title="Link to this definition"></a></dt>
<dd><p>Determine Z-matrix atom order based on molecular connectivity and an optional single constraint.</p>
<p>Uses a BFS on the heavy-atom graph to establish a base ordering, then partitions
unconstrained atoms from constrained (moving) atoms/groups so that unconstrained
heavies come first, then unconstrained hydrogens, then constrained anchors/move atoms
(or their entire groups).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>Molecule</em>) – The Molecule object containing <code class="docutils literal notranslate"><span class="pre">atoms</span></code> and <code class="docutils literal notranslate"><span class="pre">edges</span></code>.</p></li>
<li><p><strong>fragment</strong> (<em>List</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – Optional list of 0-based atom indices to include; defaults to all atoms.</p></li>
<li><p><strong>constraints_dict</strong> – Optional dict with a single constraint type:
‘R_atom’: [(move_idx, anchor_idx)]
‘R_group’: [(move_idx, anchor_idx)]
‘A_atom’: [(move_idx, ref1, ref2)]
‘A_group’: [(move_idx, ref1, ref2)]
‘D_atom’: [(move_idx, ref1, ref2, ref3)]
‘D_group’: [(move_idx, ref1, ref2, ref3)]
‘D_groups’: [(pivot2, pivot3, ref?, ref?)]</p></li>
<li><p><strong>xyz</strong> (<em>dict</em><em>, </em><em>optional</em>) – Optional 3D coordinates dict, used for checking linear motifs to avoid starting with them.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of atom indices in Z-matrix order, where any unconstrained
heavy atoms come first, then unconstrained hydrogens, then the
constrained anchor(s) and moving atom(s) or their groups, so that
modifying the specified internal coordinate translates/rotates only
the intended atoms.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="arc.species.zmat.get_atom_order_from_xyz">
<span class="sig-prename descclassname"><span class="pre">arc.species.zmat.</span></span><span class="sig-name descname"><span class="pre">get_atom_order_from_xyz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xyz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/arc/species/zmat.html#get_atom_order_from_xyz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#arc.species.zmat.get_atom_order_from_xyz" title="Link to this definition"></a></dt>
<dd><p>Get the order in which atoms should be added to the zmat from the 3D geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xyz</strong> (<em>dict</em>) – The 3D coordinates.</p></li>
<li><p><strong>fragment</strong> (<em>List</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – Entries are 0-indexed atom indices to consider in the molecule.
Only atoms within the fragment are considered.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The atom order, 0-indexed.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="arc.species.zmat.get_connectivity">
<span class="sig-prename descclassname"><span class="pre">arc.species.zmat.</span></span><span class="sig-name descname"><span class="pre">get_connectivity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Molecule</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/arc/species/zmat.html#get_connectivity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#arc.species.zmat.get_connectivity" title="Link to this definition"></a></dt>
<dd><p>Get the connectivity information from the molecule object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mol</strong> (<em>Molecule</em>) – The Molecule object.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>The connectivity information.</dt><dd><p>Keys are atom indices, values are tuples of respective edges, ordered with heavy atoms first.
All indices are 0-indexed, corresponding to atom indices in <code class="docutils literal notranslate"><span class="pre">mol</span></code> (not in the zmat).
<code class="docutils literal notranslate"><span class="pre">None</span></code> if <code class="docutils literal notranslate"><span class="pre">xyz</span></code> is given.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[int, List[int]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="arc.species.zmat.get_parameter_from_atom_indices">
<span class="sig-prename descclassname"><span class="pre">arc.species.zmat.</span></span><span class="sig-name descname"><span class="pre">get_parameter_from_atom_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zmat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xyz_indexed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span></span></span><a class="reference internal" href="../_modules/arc/species/zmat.html#get_parameter_from_atom_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#arc.species.zmat.get_parameter_from_atom_indices" title="Link to this definition"></a></dt>
<dd><p>Get the zmat parameter from the atom indices.
If indices are of length two, three, or four, an R, A, or D parameter is returned, respectively.</p>
<p>If a requested parameter represents an angle split by a dummy atom,
combine the two dummy angles to get the original angle.
In this case, a list of the two corresponding parameters will be returned.</p>
<p class="rubric">Examples</p>
<p>[0, 2] –&gt; ‘R_0_2’, or ‘R_0|1_2_5’, etc.
[0, 2, 4] –&gt; ‘A_0_2_4’, or a respective consolidated key
[0, 2, 4, 9] –&gt; ‘D_0_2_4_9’, or a respective consolidated key</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>zmat</strong> (<em>dict</em>) – The zmat.</p></li>
<li><p><strong>indices</strong> (<em>Union</em><em>[</em><em>list</em><em>, </em><em>tuple</em><em>]</em>) – Entries are 0-indices of atoms, list is of length 2, 3, or 4.</p></li>
<li><p><strong>xyz_indexed</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the atom indices relate to the xyz (and the zmat map will be used)
or they already relate to the zmat. Default is <code class="docutils literal notranslate"><span class="pre">True</span></code> (relate to xyz).</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TypeError</strong> – If <code class="docutils literal notranslate"><span class="pre">indices</span></code> are of wrong type.</p></li>
<li><p><strong>ZMatError</strong> – If <code class="docutils literal notranslate"><span class="pre">indices</span></code> has a wrong length, or not all indices are in the zmat map.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Returns: Union[str, tuple, list]</dt><dd><p>The corresponding zmat parameter.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="arc.species.zmat.is_atom_in_linear_angle">
<span class="sig-prename descclassname"><span class="pre">arc.species.zmat.</span></span><span class="sig-name descname"><span class="pre">is_atom_in_linear_angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xyz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.9</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/arc/species/zmat.html#is_atom_in_linear_angle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#arc.species.zmat.is_atom_in_linear_angle" title="Link to this definition"></a></dt>
<dd><p>Check if atom i is involved in a linear A–B–C motif (i.e., angle ~180),
whether as A, B, or C.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="arc.species.zmat.is_atom_in_new_fragment">
<span class="sig-prename descclassname"><span class="pre">arc.species.zmat.</span></span><span class="sig-name descname"><span class="pre">is_atom_in_new_fragment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zmat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/arc/species/zmat.html#is_atom_in_new_fragment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#arc.species.zmat.is_atom_in_new_fragment" title="Link to this definition"></a></dt>
<dd><p>Whether an atom is present in a new fragment that hasn’t been added to the zmat yet,
and therefore atom assignment should not be done based on connectivity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom_index</strong> (<em>int</em>) – The 0-index of the atom in the molecule or cartesian coordinates to be added.
(<code class="docutils literal notranslate"><span class="pre">n</span></code> and <code class="docutils literal notranslate"><span class="pre">atom_index</span></code> refer to the same atom, but it might have different indices
in the zmat/molecule/xyz/fragments)</p></li>
<li><p><strong>zmat</strong> (<em>dict</em>) – The zmat.</p></li>
<li><p><strong>skip_atoms</strong> (<em>list</em>) – Atoms in the zmat map to ignore when checking fragments.</p></li>
<li><p><strong>fragments</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Fragments represented by the species, i.e., as in a VdW well or a TS.
Entries are atom index lists of all atoms in a fragment, each list represents a different fragment.
indices are 0-indexed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Whether to consider connectivity for assigning atoms in z-mat variables.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="arc.species.zmat.is_dummy">
<span class="sig-prename descclassname"><span class="pre">arc.species.zmat.</span></span><span class="sig-name descname"><span class="pre">is_dummy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zmat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zmat_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/arc/species/zmat.html#is_dummy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#arc.species.zmat.is_dummy" title="Link to this definition"></a></dt>
<dd><p>Determine whether an atom in a zmat is a dummy atom by its zmat index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>zmat</strong> (<em>dict</em>) – The zmat with symbol and map information.</p></li>
<li><p><strong>zmat_index</strong> (<em>int</em>) – The atom index in the zmat.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ZMatError</strong> – If the index is invalid.</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Whether the atom represents a dummy atom ‘X’. <code class="docutils literal notranslate"><span class="pre">True</span></code> if it does.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="arc.species.zmat.map_index_to_int">
<span class="sig-prename descclassname"><span class="pre">arc.species.zmat.</span></span><span class="sig-name descname"><span class="pre">map_index_to_int</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="../_modules/arc/species/zmat.html#map_index_to_int"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#arc.species.zmat.map_index_to_int" title="Link to this definition"></a></dt>
<dd><p>Convert a zmat map value, e.g., 1 or ‘X15’, into an int, e.g., 1 or 15.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>index</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>str</em><em>]</em>) – The map index.</p>
</dd>
</dl>
<p>Returns: int</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="arc.species.zmat.order_fragments_by_constraints">
<span class="sig-prename descclassname"><span class="pre">arc.species.zmat.</span></span><span class="sig-name descname"><span class="pre">order_fragments_by_constraints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fragments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraints_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/arc/species/zmat.html#order_fragments_by_constraints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#arc.species.zmat.order_fragments_by_constraints" title="Link to this definition"></a></dt>
<dd><p>Get the order in which atoms should be added to the zmat from a 2D or a 3D representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fragments</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>int</em><em>]</em><em>]</em>) – Fragments represented by the species, i.e., as in a VdW well or a TS.
Entries are atom index lists of all atoms in a fragment, each list represents a different fragment.</p></li>
<li><p><strong>constraints_dict</strong> (<em>dict</em><em>, </em><em>optional</em>) – A dictionary of atom constraints. The function will try to find an atom order in which all constrained atoms
are after the atoms they are constraint to.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The ordered fragments list.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[List[int]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="arc.species.zmat.purge_references_to_atom_0">
<span class="sig-prename descclassname"><span class="pre">arc.species.zmat.</span></span><span class="sig-name descname"><span class="pre">purge_references_to_atom_0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zmat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/arc/species/zmat.html#purge_references_to_atom_0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#arc.species.zmat.purge_references_to_atom_0" title="Link to this definition"></a></dt>
<dd><p>Replace any Z-matrix parameter referencing atom 0 with valid alternatives.
Ensures only atoms with index &lt; current are used as references (Z-matrix rule).
Leaves map untouched. Atom 0 is still present and must be removed later.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="arc.species.zmat.rebuild_map">
<span class="sig-prename descclassname"><span class="pre">arc.species.zmat.</span></span><span class="sig-name descname"><span class="pre">rebuild_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">old_map</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropped_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/arc/species/zmat.html#rebuild_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#arc.species.zmat.rebuild_map" title="Link to this definition"></a></dt>
<dd><p>Rebuild the Z-matrix to XYZ index map after removing atom 0.</p>
<ul class="simple">
<li><p>Z-matrix indices (keys) are shifted down by 1 if &gt; 0</p></li>
<li><p>XYZ indices (values) are shifted down by 1 if &gt; dropped_idx</p></li>
<li><p>Dummy atoms (‘Xn’) are handled appropriately</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>old_map</strong> (<em>dict</em>) – Original map from Z-matrix to XYZ indices (int or ‘Xn’)</p></li>
<li><p><strong>dropped_idx</strong> (<em>int</em>) – Cartesian index of the removed atom</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>New map with updated indices</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="arc.species.zmat.remove_zmat_atom_0">
<span class="sig-prename descclassname"><span class="pre">arc.species.zmat.</span></span><span class="sig-name descname"><span class="pre">remove_zmat_atom_0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zmat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/arc/species/zmat.html#remove_zmat_atom_0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#arc.species.zmat.remove_zmat_atom_0" title="Link to this definition"></a></dt>
<dd><p>Remove atom 0 from a Z-matrix complete structure, dropping all references to it
and renumbering the remaining atoms, parameters, and map accordingly.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="arc.species.zmat.renumber_params">
<span class="sig-prename descclassname"><span class="pre">arc.species.zmat.</span></span><span class="sig-name descname"><span class="pre">renumber_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zmat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/arc/species/zmat.html#renumber_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#arc.species.zmat.renumber_params" title="Link to this definition"></a></dt>
<dd><p>Renumber all atom indices in param names in both <cite>coords</cite> and <cite>vars</cite>.
Returns a self-consistent Z-matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>zmat</strong> (<em>dict</em>) – The Z-matrix dict with ‘coords’ and ‘vars’</p></li>
<li><p><strong>delta</strong> (<em>int</em>) – The value to shift all indices by (usually -1)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated Z-matrix with renamed param strings and values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="arc.species.zmat.up_param">
<span class="sig-prename descclassname"><span class="pre">arc.species.zmat.</span></span><span class="sig-name descname"><span class="pre">up_param</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">increment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">increment_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../_modules/arc/species/zmat.html#up_param"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#arc.species.zmat.up_param" title="Link to this definition"></a></dt>
<dd><p>Increase the indices represented by a zmat parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param</strong> (<em>str</em>) – The zmat parameter, e.g., ‘D_4_2_1_0’.</p></li>
<li><p><strong>increment</strong> (<em>int</em><em>, </em><em>optional</em>) – Uniform value to add to each index.</p></li>
<li><p><strong>increment_list</strong> (<em>list</em><em>, </em><em>optional</em>) – Individual increments per index.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ZMatError</strong> – If no increment was provided or resulting index is negative.</p>
</dd>
</dl>
<dl class="simple">
<dt>Returns: str</dt><dd><p>The new parameter with increased indices.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="arc.species.zmat.update_zmat_with_new_atom">
<span class="sig-prename descclassname"><span class="pre">arc.species.zmat.</span></span><span class="sig-name descname"><span class="pre">update_zmat_with_new_atom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zmat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xyz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">added_dummy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/arc/species/zmat.html#update_zmat_with_new_atom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#arc.species.zmat.update_zmat_with_new_atom" title="Link to this definition"></a></dt>
<dd><p>Update the zmat with a new atom.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>zmat</strong> (<em>dict</em>) – The zmat.</p></li>
<li><p><strong>xyz</strong> (<em>dict</em>) – The xyz dict.</p></li>
<li><p><strong>coords</strong> (<em>Union</em><em>[</em><em>list</em><em>, </em><em>tuple</em><em>]</em>) – Just the ‘coords’ part of the xyz dict.</p></li>
<li><p><strong>n</strong> (<em>int</em>) – The 0-index of the atom in the zmat to be added.</p></li>
<li><p><strong>atom_index</strong> (<em>int</em>) – The 0-index of the atom in the molecule or cartesian coordinates to be added.
(<code class="docutils literal notranslate"><span class="pre">n</span></code> and <code class="docutils literal notranslate"><span class="pre">atom_index</span></code> refer to the same atom, but it might have different indices
in the zmat and the molecule/xyz)</p></li>
<li><p><strong>r_atoms</strong> (<em>list</em>) – The R atom index descriptors.</p></li>
<li><p><strong>a_atoms</strong> (<em>list</em>) – The A atom index descriptors.</p></li>
<li><p><strong>d_atoms</strong> (<em>list</em>) – The D atom index descriptors.</p></li>
<li><p><strong>added_dummy</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether a dummy atom was added as the last index of a_atoms.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated zmat.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="arc.species.zmat.xyz_to_zmat">
<span class="sig-prename descclassname"><span class="pre">arc.species.zmat.</span></span><span class="sig-name descname"><span class="pre">xyz_to_zmat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xyz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Molecule</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">consolidate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">consolidation_tols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/arc/species/zmat.html#xyz_to_zmat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#arc.species.zmat.xyz_to_zmat" title="Link to this definition"></a></dt>
<dd><p>Generate a z-matrix from cartesian coordinates.
The zmat is a dictionary with the following keys:
- ‘symbols’: a tuple of strings representing atomic symbols; defined as a list and converted to a tuple
- ‘coords’: a tuple of tuples representing internal coordinates; defined as a list and converted to a tuple
- ‘vars’: a dictionary of all variables defined for the coordinates
- ‘map’: a dictionary connecting atom indices in the zmat (keys) to atom indices in the mol/coords (values)
This function assumes <code class="docutils literal notranslate"><span class="pre">xyz</span></code> has no dummy atoms.
This function does not attempt to resolve constrain locks, and assumes only few non-circular constraints were given.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xyz</strong> (<em>dict</em>) – The xyz coordinates.</p></li>
<li><p><strong>mol</strong> (<em>Molecule</em><em>, </em><em>optional</em>) – The corresponding RMG Molecule. If given, the bonding information will be used
to generate a more meaningful zmat.</p></li>
<li><p><strong>constraints</strong> (<em>dict</em><em>, </em><em>optional</em>) – Accepted keys are:
‘R_atom’, ‘R_group’,
‘A_atom’, ‘A_group’,
‘D_atom’, ‘D_group’.
‘R’, ‘A’, and ‘D’ are constrain distances, angles, and dihedrals, respectively.
Values are lists of atom index tuples (0-indexed). The atom indices order matters.
Specifying ‘_atom’ will cause only the first atom in the specified list values
to translate/rotate if the corresponding zmat parameter is changed.
Specifying ‘_group’ will cause the entire group connected to the first atom
to translate/rotate if the corresponding zmat parameter is changed.
Specifying ‘_groups’ (only valid for D) will cause the groups connected to
the first two atoms to translate/rotate if the corresponding parameter is changed.
Note that ‘D_groups’ should not be passed directly to this function, but to
arc.species.converter.modify_coords() instead (it is a composite constraint).</p></li>
<li><p><strong>consolidate</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to consolidate the zmat after generation, <code class="docutils literal notranslate"><span class="pre">True</span></code> to consolidate.</p></li>
<li><p><strong>consolidation_tols</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keys are ‘R’, ‘A’, ‘D’, values are floats representing absolute tolerance
for consolidating almost equal internal coordinates.</p></li>
<li><p><strong>fragments</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Fragments represented by the species, i.e., as in a VdW well or a TS.
Entries are atom index lists of all atoms in a fragment, each list represents a different fragment.
indices are 0-indexed.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ZMatError</strong> – If the zmat could not be generated.</p>
</dd>
</dl>
<dl class="simple">
<dt>Returns: Dict[str, tuple]</dt><dd><p>The z-matrix.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="arc.species.zmat.zmat_to_coords">
<span class="sig-prename descclassname"><span class="pre">arc.species.zmat.</span></span><span class="sig-name descname"><span class="pre">zmat_to_coords</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zmat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_dummy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_undefined</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/arc/species/zmat.html#zmat_to_coords"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#arc.species.zmat.zmat_to_coords" title="Link to this definition"></a></dt>
<dd><p>Generate the cartesian coordinates from a zmat dict.
Considers the zmat atomic map so the returned coordinates is ordered correctly.
Most common isotopes assumed, if this is not the case, then isotopes should be reassigned to the xyz.
This function assumes that all zmat variables relate to already defined atoms with a lower index in the zmat.</p>
<p>This function implements the SN-NeRF algorithm as described in:
J. Parsons, J.B. Holmes, J.M Rojas, J. Tsai, C.E.M. Strauss, “Practical Conversion from Torsion Space to Cartesian
Space for In Silico Protein Synthesis”, Journal of Computational Chemistry 2005, 26 (10), 1063-1068,
<a class="reference external" href="https://doi.org/10.1002/jcc.20237">https://doi.org/10.1002/jcc.20237</a></p>
<p>Tested in converterTest.py rather than zmatTest</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>zmat</strong> (<em>dict</em>) – The zmat.</p></li>
<li><p><strong>keep_dummy</strong> (<em>bool</em>) – Whether to keep dummy atoms (‘X’), <code class="docutils literal notranslate"><span class="pre">True</span></code> to keep, default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>skip_undefined</strong> (<em>bool</em>) – Whether to skip atoms with undefined variables, instead of raising an error.
<code class="docutils literal notranslate"><span class="pre">True</span></code> to skip, default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ZMatError</strong> – If zmat is of wrong type or does not contain all keys.</p>
</dd>
</dl>
<dl class="simple">
<dt>Returns: Tuple[List[dict], List[str]]</dt><dd><ul class="simple">
<li><p>The cartesian coordinates.</p></li>
<li><p>The atomic symbols corresponding to the coordinates.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="vectors.html" class="btn btn-neutral float-left" title="arc.species.vectors" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="reaction.html" class="btn btn-neutral float-right" title="arc.reaction" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018-2025, Alon Grinberg Dana.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>