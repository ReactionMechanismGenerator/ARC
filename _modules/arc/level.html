

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>arc.level &mdash; ARC 1.1.0 Documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> ARC
          

          
          </a>

          
            
            
              <div class="version">
                1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../running.html">Running ARC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced.html">Advanced Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../output.html">Output</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">ARCâ€™s API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools.html">Standalone tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../media.html">Media</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contribute.html">Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cite.html">How to cite ARC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../licence.html">Licence</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">ARC</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>arc.level</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for arc.level</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">A module for working with levels of theory.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">import</span> <span class="nn">arkane.encorr.data</span> <span class="k">as</span> <span class="nn">arkane_data</span>
<span class="kn">from</span> <span class="nn">arkane.encorr.bac</span> <span class="kn">import</span> <span class="n">BAC</span>
<span class="kn">from</span> <span class="nn">arkane.modelchem</span> <span class="kn">import</span> <span class="n">METHODS_THAT_REQUIRE_SOFTWARE</span><span class="p">,</span> <span class="n">LevelOfTheory</span><span class="p">,</span> <span class="n">standardize_name</span>

<span class="kn">from</span> <span class="nn">arc.common</span> <span class="kn">import</span> <span class="n">ARC_PATH</span><span class="p">,</span> <span class="n">get_logger</span><span class="p">,</span> <span class="n">get_ordered_intersection_of_two_lists</span><span class="p">,</span> <span class="n">read_yaml_file</span>
<span class="kn">from</span> <span class="nn">arc.imports</span> <span class="kn">import</span> <span class="n">settings</span>


<span class="n">logger</span> <span class="o">=</span> <span class="n">get_logger</span><span class="p">()</span>


<span class="n">levels_ess</span><span class="p">,</span> <span class="n">supported_ess</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;levels_ess&#39;</span><span class="p">],</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;supported_ess&#39;</span><span class="p">]</span>


<div class="viewcode-block" id="Level"><a class="viewcode-back" href="../../api/level.html#arc.level.Level">[docs]</a><span class="k">class</span> <span class="nc">Level</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Uniquely defines the settings used for a quantum calculation level of theory.</span>
<span class="sd">    Either ``repr`` or ``method`` must be specified.</span>

<span class="sd">    Args:</span>
<span class="sd">        repr (str, dict, Level optional): A dictionary or a simple string representation of the level of theory,</span>
<span class="sd">                                          e.g. &quot;wb97xd/def2-tzvp&quot;, or {&#39;method&#39;: &#39;b3lyp&#39;, &#39;basis&#39;: &#39;6-31g&#39;}.</span>
<span class="sd">                                          Not in ``LevelOfTheory``.</span>
<span class="sd">        method (str, optional): Quantum chemistry method.</span>
<span class="sd">        basis (str, optional): Basis set.</span>
<span class="sd">        auxiliary_basis (str, optional): Auxiliary basis set for correlated methods.</span>
<span class="sd">        dispersion (str, optional): The DFT dispersion info (if not already included in method).</span>
<span class="sd">        cabs (str, optional): Complementary auxiliary basis set for F12 calculations.</span>
<span class="sd">        method_type (str, optional): The level of theory method type (DFT, wavefunction, force field, semi-empirical,</span>
<span class="sd">                                     or composite). Not in ``LevelOfTheory``.</span>
<span class="sd">        software (str, optional): Quantum chemistry software.</span>
<span class="sd">        software_version (Union[int, float, str], optional): Quantum chemistry software version.</span>
<span class="sd">        solvation_method (str, optional): Solvation method.</span>
<span class="sd">        solvent (str, optional): The solvent. Values are strings of &quot;known&quot; solvents, see https://gaussian.com/scrf/.</span>
<span class="sd">        solvation_scheme_level (Level, optional): A Level class representing the level of theory to calculate a</span>
<span class="sd">                                                  solvation energy correction at. Not in ``LevelOfTheory``.</span>
<span class="sd">        args (Dict[Dict[str, str]], optional): Additional arguments provided to the software.</span>
<span class="sd">                                               Different than the ``args`` in ``LevelOfTheory``.</span>
<span class="sd">        compatible_ess (list, optional): Entries are names of compatible ESS. Not in ``LevelOfTheory``.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="nb">repr</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">Level</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">method</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">basis</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">auxiliary_basis</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">dispersion</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">cabs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">method_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">software</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">software_version</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">compatible_ess</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">solvation_method</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">solvent</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">solvation_scheme_level</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Level</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">args</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">Iterable</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">repr</span> <span class="o">=</span> <span class="nb">repr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">method</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Either repr or method must be specified, not both.</span><span class="se">\n</span><span class="s1">&#39;</span>
                             <span class="sa">f</span><span class="s1">&#39;Got: &quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">repr</span><span class="si">}</span><span class="s1">&quot; and &quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="si">}</span><span class="s1">&quot;.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Either repr or method must be specified, got neither.&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">basis</span> <span class="o">=</span> <span class="n">basis</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auxiliary_basis</span> <span class="o">=</span> <span class="n">auxiliary_basis</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dispersion</span> <span class="o">=</span> <span class="n">dispersion</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cabs</span> <span class="o">=</span> <span class="n">cabs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">method_type</span> <span class="o">=</span> <span class="n">method_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">software</span> <span class="o">=</span> <span class="n">software</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">software_version</span> <span class="o">=</span> <span class="n">software_version</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compatible_ess</span> <span class="o">=</span> <span class="n">compatible_ess</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">solvation_method</span> <span class="o">=</span> <span class="n">solvation_method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">solvent</span> <span class="o">=</span> <span class="n">solvent</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">solvation_scheme_level</span><span class="p">,</span> <span class="p">(</span><span class="nb">dict</span><span class="p">,</span> <span class="nb">str</span><span class="p">)):</span>
            <span class="n">solvation_scheme_level</span> <span class="o">=</span> <span class="n">Level</span><span class="p">(</span><span class="nb">repr</span><span class="o">=</span><span class="n">solvation_scheme_level</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">solvation_scheme_level</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> \
                <span class="ow">and</span> <span class="p">(</span><span class="n">solvation_scheme_level</span><span class="o">.</span><span class="n">solvent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                     <span class="ow">or</span> <span class="n">solvation_scheme_level</span><span class="o">.</span><span class="n">solvation_method</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                     <span class="ow">or</span> <span class="n">solvation_scheme_level</span><span class="o">.</span><span class="n">solvation_scheme_level</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Cannot represent a solvation_scheme_level which itself has solvation attributes.&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">solvation_scheme_level</span> <span class="o">=</span> <span class="n">solvation_scheme_level</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solvation_method</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">solvent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Cannot represent a level of theory with a solvation method (&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">solvation_method</span><span class="si">}</span><span class="s1">&quot;) &#39;</span>
                             <span class="sa">f</span><span class="s1">&#39;that lacks a solvent.&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span> <span class="ow">or</span> <span class="p">{</span><span class="s1">&#39;keyword&#39;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(),</span> <span class="s1">&#39;block&#39;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">()}</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deduce_method_type</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispersion</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">method_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;dft&#39;</span><span class="p">,</span> <span class="s1">&#39;composite&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Dispersion is only allowed for DFT (or composite) methods, got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dispersion</span><span class="si">}</span><span class="s1"> &#39;</span>
                             <span class="sa">f</span><span class="s1">&#39;for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="si">}</span><span class="s1"> which is a </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">method_type</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">software</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># it wasn&#39;t set by the user, try determining it</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deduce_software</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Level</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine equality between Level object instances.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Level</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">LevelOfTheory</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">method</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">basis</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a humane-readable string representation of the object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The level of theory string representation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">str_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">str_</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">basis</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">auxiliary_basis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">str_</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;, auxiliary_basis: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">auxiliary_basis</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispersion</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">str_</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;, dispersion: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dispersion</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cabs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">str_</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;, cabs: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cabs</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solvation_method</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">str_</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;, solvation_method: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">solvation_method</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solvent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">str_</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;, solvent: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">solvent</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solvation_scheme_level</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">str_</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, solvation_scheme_level: &#39;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">solvation_scheme_level</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">software</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">str_</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;, software: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">software</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">software_version</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">str_</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;, software_version: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">software_version</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="n">val</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">values</span><span class="p">()]):</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;keyword&#39;</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">keys</span><span class="p">()]):</span>
                <span class="n">str_</span> <span class="o">+=</span> <span class="s1">&#39;, keyword args:&#39;</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">arg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;keyword&#39;</span><span class="p">:</span>
                        <span class="n">str_</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39; </span><span class="si">{</span><span class="n">arg</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">return</span> <span class="n">str_</span>

<div class="viewcode-block" id="Level.copy"><a class="viewcode-back" href="../../api/level.html#arc.level.Level.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A method to create a copy of the object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Level: A copy of the object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Level</span><span class="p">(</span><span class="nb">repr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">as_dict</span><span class="p">())</span></div>

<div class="viewcode-block" id="Level.simple"><a class="viewcode-back" href="../../api/level.html#arc.level.Level.simple">[docs]</a>    <span class="k">def</span> <span class="nf">simple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a simple humane-readable string representation of the object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The simple level of theory string representation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">str_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">str_</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">basis</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">return</span> <span class="n">str_</span></div>

<div class="viewcode-block" id="Level.as_dict"><a class="viewcode-back" href="../../api/level.html#arc.level.Level.as_dict">[docs]</a>    <span class="k">def</span> <span class="nf">as_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a minimal dictionary representation from which the object can be reconstructed.</span>
<span class="sd">        Useful for ARC restart files.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">original_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span>
        <span class="n">clean_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">original_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">key</span> <span class="o">!=</span> <span class="s1">&#39;args&#39;</span> <span class="ow">or</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;args&#39;</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">values</span><span class="p">()]):</span>
                <span class="n">clean_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
        <span class="k">return</span> <span class="n">clean_dict</span></div>

<div class="viewcode-block" id="Level.build"><a class="viewcode-back" href="../../api/level.html#arc.level.Level.build">[docs]</a>    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assign object attributes from a dictionary representation of the object or a simple string (&quot;method/basis&quot;).</span>
<span class="sd">        Useful for ARC restart files.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">level_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;basis&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="s1">&#39;auxiliary_basis&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="s1">&#39;dispersion&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="s1">&#39;cabs&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="s1">&#39;method_type&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="s1">&#39;software&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="s1">&#39;software_version&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="s1">&#39;compatible_ess&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="s1">&#39;solvation_method&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="s1">&#39;solvent&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="s1">&#39;solvation_scheme_level&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="s1">&#39;args&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
        <span class="n">allowed_keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">level_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">repr</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="s1">&#39; &#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr</span><span class="p">:</span>
                <span class="c1"># illegal inputs like &#39;dlpno-ccsd(t)/def2-svp def2-svp/c&#39; or &#39;b3 lyp&#39;</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">repr</span><span class="si">}</span><span class="s1"> has empty spaces. Please use a dictionary format &#39;</span>
                                 <span class="sa">f</span><span class="s1">&#39;to clearly specify method, basis, auxiliary basis, and dispersion in this case. &#39;</span>
                                 <span class="sa">f</span><span class="s1">&#39;See documentation for more details.&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
                <span class="c1"># illegal inputs like &#39;dlpno-ccsd(t)/def2-svp/def2-svp/c&#39;</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">repr</span><span class="si">}</span><span class="s1"> has multiple slashes. Please use a dictionary format &#39;</span>
                                 <span class="sa">f</span><span class="s1">&#39;to specify method, basis, auxiliary basis, and dispersion in this case. &#39;</span>
                                 <span class="sa">f</span><span class="s1">&#39;See documentation for more details.&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;/&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr</span><span class="p">:</span>
                <span class="c1"># e.g., &#39;AM1&#39;, &#39;XTB&#39;, &#39;CBS-QB3&#39;</span>
                <span class="c1"># Note that this function is not designed to distinguish between composite and semi-empirical methods.</span>
                <span class="n">level_dict</span><span class="p">[</span><span class="s1">&#39;method&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">splits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
                <span class="n">level_dict</span><span class="p">[</span><span class="s1">&#39;method&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">level_dict</span><span class="p">[</span><span class="s1">&#39;basis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">splits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">repr</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="c1"># also treats representations of LevelOfTheory.as_dict from a restart file</span>
            <span class="k">if</span> <span class="s1">&#39;method&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The repr dictionary argument must at least have a &quot;method&quot; key, got:</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">repr</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">allowed_keys</span> <span class="ow">and</span> <span class="n">value</span><span class="p">:</span>
                    <span class="n">level_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
                <span class="k">elif</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_keys</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Got an illegal key &quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">&quot; in level of theory dictionary representation&#39;</span>
                                     <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">repr</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">repr</span><span class="p">,</span> <span class="n">Level</span><span class="p">):</span>
            <span class="n">level_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr</span><span class="o">.</span><span class="n">as_dict</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The repr argument must be either a string, a dictionary or a Level type.</span><span class="se">\n</span><span class="s1">&#39;</span>
                             <span class="sa">f</span><span class="s1">&#39;Got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">repr</span><span class="si">}</span><span class="s1"> which is a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">repr</span><span class="p">)</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">repr</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># reset</span>
        <span class="bp">self</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">level_dict</span><span class="p">)</span></div>

<div class="viewcode-block" id="Level.lower"><a class="viewcode-back" href="../../api/level.html#arc.level.Level.lower">[docs]</a>    <span class="k">def</span> <span class="nf">lower</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set arguments to lowercase.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">basis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">auxiliary_basis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">auxiliary_basis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">auxiliary_basis</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispersion</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dispersion</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispersion</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cabs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cabs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cabs</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">method_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">method_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">software</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">software</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">software</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">software_version</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">software_version</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">software_version</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solvation_method</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">solvation_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">solvation_method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solvent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">solvent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">solvent</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

        <span class="n">args</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;keyword&#39;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(),</span> <span class="s1">&#39;block&#39;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">()}</span>

        <span class="c1"># 1st level dict, set self.args in place</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;All entries in the args argument must be strings.</span><span class="se">\n</span><span class="s1">&#39;</span>
                                     <span class="sa">f</span><span class="s1">&#39;Got </span><span class="si">{</span><span class="n">arg</span><span class="si">}</span><span class="s1"> which is a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span><span class="si">}</span><span class="s1"> in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">arg</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;keyword&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;general&#39;</span><span class="p">:</span> <span class="n">args</span><span class="o">.</span><span class="n">lower</span><span class="p">()},</span> <span class="s1">&#39;block&#39;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">()}</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The args argument must be either a string, an iterable or a dictionary.</span><span class="se">\n</span><span class="s1">&#39;</span>
                             <span class="sa">f</span><span class="s1">&#39;Got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="si">}</span><span class="s1"> which is a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">)</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>

        <span class="c1"># 2nd level dict, set in args, then transfer to self.args</span>
        <span class="k">for</span> <span class="n">key1</span><span class="p">,</span> <span class="n">val1</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">args</span><span class="p">[</span><span class="n">key1</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val1</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">key2</span><span class="p">,</span> <span class="n">val2</span> <span class="ow">in</span> <span class="n">val1</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">new_val2</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">val2</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val2</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="k">else</span> <span class="n">val2</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_val2</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;All entries in the args argument must be str, int, or float types.</span><span class="se">\n</span><span class="s1">&#39;</span>
                                         <span class="sa">f</span><span class="s1">&#39;Got </span><span class="si">{</span><span class="n">new_val2</span><span class="si">}</span><span class="s1"> which is a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">new_val2</span><span class="p">)</span><span class="si">}</span><span class="s1"> in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>
                    <span class="n">args</span><span class="p">[</span><span class="n">key1</span><span class="o">.</span><span class="n">lower</span><span class="p">()][</span><span class="n">key2</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="n">new_val2</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val1</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">args</span><span class="p">[</span><span class="n">key1</span><span class="o">.</span><span class="n">lower</span><span class="p">()][</span><span class="s1">&#39;general&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">val1</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val1</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
                <span class="k">for</span> <span class="n">v1</span> <span class="ow">in</span> <span class="n">val1</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;All entries in the args argument must be strings.</span><span class="se">\n</span><span class="s1">&#39;</span>
                                         <span class="sa">f</span><span class="s1">&#39;Got </span><span class="si">{</span><span class="n">v1</span><span class="si">}</span><span class="s1"> which is a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span><span class="si">}</span><span class="s1"> in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>
                <span class="n">args</span><span class="p">[</span><span class="s1">&#39;keyword&#39;</span><span class="p">][</span><span class="s1">&#39;general&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">v1</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">v1</span> <span class="ow">in</span> <span class="n">val1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Values of the args dictionary must be either dictionaries, strings, or lists, &#39;</span>
                                 <span class="sa">f</span><span class="s1">&#39;got </span><span class="si">{</span><span class="n">val1</span><span class="si">}</span><span class="s1"> which is a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">val1</span><span class="p">)</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span></div>

<div class="viewcode-block" id="Level.to_arkane_level_of_theory"><a class="viewcode-back" href="../../api/level.html#arc.level.Level.to_arkane_level_of_theory">[docs]</a>    <span class="k">def</span> <span class="nf">to_arkane_level_of_theory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                  <span class="n">variant</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                                  <span class="n">bac_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span>
                                  <span class="n">comprehensive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                                  <span class="n">raise_error</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                                  <span class="n">warn</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                                  <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">LevelOfTheory</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert ``Level`` to an Arkane ``LevelOfTheory`` instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            variant (str, optional): Return a variant of the Arkane ``LevelOfTheory`` that matches an Arkane query.</span>
<span class="sd">                                     Allowed values are ``&#39;freq&#39;``, ``&#39;AEC&#39;``, ``&#39;BEC&#39;``. Returns ``None`` if no</span>
<span class="sd">                                     functioning variant was found.</span>
<span class="sd">            bac_type (str, optional): The BAC type (&#39;p&#39; or &#39;m&#39;) to use when searching for a ``LevelOfTheory`` variant</span>
<span class="sd">                                      for BAC.</span>
<span class="sd">            comprehensive (bool, optional): Whether to consider all relevant arguments if not looking for a variant.</span>
<span class="sd">            raise_error (bool, optional): Whether to raise an error if an AEC variant could not be found.</span>
<span class="sd">            warn (bool, optional): Whether to output a warning if an AEC variant could not be found.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Optional[LevelOfTheory]: The respective Arkane ``LevelOfTheory`` object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">level_aec</span> <span class="o">=</span> <span class="n">read_yaml_file</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ARC_PATH</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;AEC.yml&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="ow">in</span> <span class="n">level_aec</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">variant</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">comprehensive</span><span class="p">:</span>
                <span class="c1"># only add basis and software if needed</span>
                <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="p">}</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;basis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;software&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">software</span>
                <span class="k">return</span> <span class="n">LevelOfTheory</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># consider all relevant arguments</span>
                <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;solvation_scheme_level&#39;</span><span class="p">]</span>
                <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;method_type&#39;</span><span class="p">]</span>
                <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;repr&#39;</span><span class="p">]</span>
                <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;compatible_ess&#39;</span><span class="p">]</span>
                <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;dispersion&#39;</span><span class="p">]</span>
                <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;args&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="n">val</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">values</span><span class="p">()]):</span>
                    <span class="c1"># only pass keyword arguments to Arkane (not blocks)</span>
                    <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;keyword&#39;</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">keys</span><span class="p">()]):</span>
                        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;args&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
                        <span class="k">for</span> <span class="n">key1</span><span class="p">,</span> <span class="n">val1</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                            <span class="k">if</span> <span class="n">key1</span> <span class="o">==</span> <span class="s1">&#39;keyword&#39;</span><span class="p">:</span>
                                <span class="k">for</span> <span class="n">val2</span> <span class="ow">in</span> <span class="n">val1</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                                    <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;args&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val2</span><span class="p">)</span>
                                <span class="k">break</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;args&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispersion</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="s1">&#39;args&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;args&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dispersion</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;args&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dispersion</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;method&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;method&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;f12a&#39;</span><span class="p">,</span> <span class="s1">&#39;f12&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;f12b&#39;</span><span class="p">,</span> <span class="s1">&#39;f12&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;basis&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;basis&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;f12a&#39;</span><span class="p">,</span> <span class="s1">&#39;f12&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;f12b&#39;</span><span class="p">,</span> <span class="s1">&#39;f12&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">LevelOfTheory</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># search for a functioning variant</span>
            <span class="k">if</span> <span class="n">variant</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">,</span> <span class="s1">&#39;AEC&#39;</span><span class="p">,</span> <span class="s1">&#39;BAC&#39;</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;variant must be either &quot;freq&quot;, &quot;AEC&quot;, or &quot;BAC&quot;, got &quot;</span><span class="si">{</span><span class="n">variant</span><span class="si">}</span><span class="s1">&quot;.&#39;</span><span class="p">)</span>
            <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="p">}</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;basis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis</span>
            <span class="k">if</span> <span class="n">standardize_name</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="p">)</span> <span class="ow">in</span> <span class="n">METHODS_THAT_REQUIRE_SOFTWARE</span><span class="p">:</span>
                <span class="c1"># add software if mandatory (otherwise, Arkane won&#39;t accept this object initialization)</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;software&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">software</span>
            <span class="n">var_2</span> <span class="o">=</span> <span class="n">LevelOfTheory</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;software&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">software</span>  <span class="c1"># add or overwrite software</span>
            <span class="c1"># start w/ the software argument (var_1) in case there are several entries that only vary by software</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">var_1</span> <span class="o">=</span> <span class="n">LevelOfTheory</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="n">var_1</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">if</span> <span class="n">variant</span> <span class="o">==</span> <span class="s1">&#39;freq&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">var_2</span>

            <span class="k">if</span> <span class="n">variant</span> <span class="o">==</span> <span class="s1">&#39;AEC&#39;</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">arkane_data</span><span class="o">.</span><span class="n">atom_energies</span><span class="p">[</span><span class="n">var_1</span><span class="p">]</span>
                    <span class="k">return</span> <span class="n">var_1</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">arkane_data</span><span class="o">.</span><span class="n">atom_energies</span><span class="p">[</span><span class="n">var_2</span><span class="p">]</span>
                        <span class="k">return</span> <span class="n">var_2</span>
                    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">raise_error</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Missing Arkane atom energy corrections for </span><span class="si">{</span><span class="n">var_1</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
                                             <span class="sa">f</span><span class="s1">&#39;(If you did not mean to compute thermo, set the compute_thermo &#39;</span>
                                             <span class="sa">f</span><span class="s1">&#39;argument to False to avoid this error.)&#39;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">warn</span><span class="p">:</span>
                                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Missing Arkane atom energy corrections for </span><span class="si">{</span><span class="n">var_1</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>
                            <span class="k">return</span> <span class="kc">None</span>

            <span class="k">if</span> <span class="n">variant</span> <span class="o">==</span> <span class="s1">&#39;BAC&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">bac_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">]:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;bac_type must be either &quot;p&quot; or &quot;m&quot;, got &quot;</span><span class="si">{</span><span class="n">bac_type</span><span class="si">}</span><span class="s1">&quot;.&#39;</span><span class="p">)</span>
                <span class="n">bac</span> <span class="o">=</span> <span class="n">BAC</span><span class="p">(</span><span class="n">level_of_theory</span><span class="o">=</span><span class="n">var_1</span><span class="p">,</span> <span class="n">bac_type</span><span class="o">=</span><span class="n">bac_type</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">bac</span><span class="o">.</span><span class="n">bacs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">bac</span> <span class="o">=</span> <span class="n">BAC</span><span class="p">(</span><span class="n">level_of_theory</span><span class="o">=</span><span class="n">var_2</span><span class="p">,</span> <span class="n">bac_type</span><span class="o">=</span><span class="n">bac_type</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">bac</span><span class="o">.</span><span class="n">bacs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Missing Arkane BAC for </span><span class="si">{</span><span class="n">var_2</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>
                        <span class="k">return</span> <span class="kc">None</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">var_2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">var_1</span></div>

<div class="viewcode-block" id="Level.deduce_method_type"><a class="viewcode-back" href="../../api/level.html#arc.level.Level.deduce_method_type">[docs]</a>    <span class="k">def</span> <span class="nf">deduce_method_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine the type of a model chemistry:</span>
<span class="sd">        DFT, wavefunction, force field, semi-empirical, or composite</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">wave_function_methods</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;hf&#39;</span><span class="p">,</span> <span class="s1">&#39;cc&#39;</span><span class="p">,</span> <span class="s1">&#39;ci&#39;</span><span class="p">,</span> <span class="s1">&#39;mp2&#39;</span><span class="p">,</span> <span class="s1">&#39;mp3&#39;</span><span class="p">,</span> <span class="s1">&#39;cp&#39;</span><span class="p">,</span> <span class="s1">&#39;cep&#39;</span><span class="p">,</span> <span class="s1">&#39;nevpt&#39;</span><span class="p">,</span> <span class="s1">&#39;dmrg&#39;</span><span class="p">,</span> <span class="s1">&#39;ri&#39;</span><span class="p">,</span> <span class="s1">&#39;cas&#39;</span><span class="p">,</span> <span class="s1">&#39;ic&#39;</span><span class="p">,</span> <span class="s1">&#39;mr&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;bd&#39;</span><span class="p">,</span> <span class="s1">&#39;mbpt&#39;</span><span class="p">]</span>
        <span class="n">semiempirical_methods</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;am&#39;</span><span class="p">,</span> <span class="s1">&#39;pm&#39;</span><span class="p">,</span> <span class="s1">&#39;zindo&#39;</span><span class="p">,</span> <span class="s1">&#39;mndo&#39;</span><span class="p">,</span> <span class="s1">&#39;xtb&#39;</span><span class="p">,</span> <span class="s1">&#39;nddo&#39;</span><span class="p">]</span>
        <span class="n">force_field_methods</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;amber&#39;</span><span class="p">,</span> <span class="s1">&#39;mmff&#39;</span><span class="p">,</span> <span class="s1">&#39;dreiding&#39;</span><span class="p">,</span> <span class="s1">&#39;uff&#39;</span><span class="p">,</span> <span class="s1">&#39;qmdff&#39;</span><span class="p">,</span> <span class="s1">&#39;gfn&#39;</span><span class="p">,</span> <span class="s1">&#39;gaff&#39;</span><span class="p">,</span> <span class="s1">&#39;ghemical&#39;</span><span class="p">,</span> <span class="s1">&#39;charmm&#39;</span><span class="p">,</span> <span class="s1">&#39;ani&#39;</span><span class="p">]</span>
        <span class="c1"># all composite methods supported by Gaussian</span>
        <span class="n">composite_methods</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;cbs-4m&#39;</span><span class="p">,</span> <span class="s1">&#39;cbs-qb3&#39;</span><span class="p">,</span> <span class="s1">&#39;cbs-qb3-paraskevas&#39;</span><span class="p">,</span> <span class="s1">&#39;rocbs-qb3&#39;</span><span class="p">,</span> <span class="s1">&#39;cbs-apno&#39;</span><span class="p">,</span> <span class="s1">&#39;w1u&#39;</span><span class="p">,</span> <span class="s1">&#39;w1ro&#39;</span><span class="p">,</span> <span class="s1">&#39;w1bd&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;g1&#39;</span><span class="p">,</span> <span class="s1">&#39;g2&#39;</span><span class="p">,</span> <span class="s1">&#39;g3&#39;</span><span class="p">,</span> <span class="s1">&#39;g4&#39;</span><span class="p">,</span> <span class="s1">&#39;g2mp2&#39;</span><span class="p">,</span> <span class="s1">&#39;g3mp2&#39;</span><span class="p">,</span> <span class="s1">&#39;g3b3&#39;</span><span class="p">,</span> <span class="s1">&#39;g3mp2b3&#39;</span><span class="p">,</span> <span class="s1">&#39;g4mp2&#39;</span><span class="p">]</span>
        <span class="c1"># Composite methods</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="ow">in</span> <span class="n">composite_methods</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">method_type</span> <span class="o">=</span> <span class="s1">&#39;composite&#39;</span>
        <span class="c1"># Special cases</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;m06hf&#39;</span><span class="p">,</span> <span class="s1">&#39;m06-hf&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">method_type</span> <span class="o">=</span> <span class="s1">&#39;dft&#39;</span>
        <span class="c1"># General cases</span>
        <span class="k">elif</span> <span class="nb">any</span><span class="p">(</span><span class="n">wf_method</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="k">for</span> <span class="n">wf_method</span> <span class="ow">in</span> <span class="n">wave_function_methods</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">method_type</span> <span class="o">=</span> <span class="s1">&#39;wavefunction&#39;</span>
        <span class="k">elif</span> <span class="nb">any</span><span class="p">(</span><span class="n">sm_method</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="k">for</span> <span class="n">sm_method</span> <span class="ow">in</span> <span class="n">semiempirical_methods</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">method_type</span> <span class="o">=</span> <span class="s1">&#39;semiempirical&#39;</span>
        <span class="k">elif</span> <span class="nb">any</span><span class="p">(</span><span class="n">ff_method</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="k">for</span> <span class="n">ff_method</span> <span class="ow">in</span> <span class="n">force_field_methods</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">method_type</span> <span class="o">=</span> <span class="s1">&#39;force_field&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># assume DFT</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">method_type</span> <span class="o">=</span> <span class="s1">&#39;dft&#39;</span></div>

<div class="viewcode-block" id="Level.deduce_software"><a class="viewcode-back" href="../../api/level.html#arc.level.Level.deduce_software">[docs]</a>    <span class="k">def</span> <span class="nf">deduce_software</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                        <span class="n">job_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deduce the ESS to be used for a given level of theory.</span>
<span class="sd">        Populates the .software attribute.</span>

<span class="sd">        Args:</span>
<span class="sd">            job_type (str, optional): An ARC job type, assists in determining the software.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># OneDMin</span>
        <span class="k">if</span> <span class="n">job_type</span> <span class="o">==</span> <span class="s1">&#39;onedmin&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;onedmin&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">supported_ess</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Could not find the OneDMin software to compute Lennard-Jones parameters.</span><span class="se">\n</span><span class="s1">&#39;</span>
                                 <span class="sa">f</span><span class="s1">&#39;levels_ess is:</span><span class="se">\n</span><span class="si">{</span><span class="n">levels_ess</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">software</span> <span class="o">=</span> <span class="s1">&#39;onedmin&#39;</span>

        <span class="c1"># QChem</span>
        <span class="k">if</span> <span class="n">job_type</span> <span class="o">==</span> <span class="s1">&#39;orbitals&#39;</span><span class="p">:</span>
            <span class="c1"># currently we only have a script to print orbitals on QChem,</span>
            <span class="c1"># could/should be elaborated to additional ESS</span>
            <span class="k">if</span> <span class="s1">&#39;qchem&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">supported_ess</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Could not find the QChem software to compute molecular orbitals.</span><span class="se">\n</span><span class="s1">&#39;</span>
                                 <span class="sa">f</span><span class="s1">&#39;levels_ess is:</span><span class="se">\n</span><span class="si">{</span><span class="n">levels_ess</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">software</span> <span class="o">=</span> <span class="s1">&#39;qchem&#39;</span>

        <span class="c1"># Orca</span>
        <span class="k">if</span> <span class="s1">&#39;dlpno&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;orca&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">supported_ess</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Could not find Orca to run a DLPNO job.</span><span class="se">\n</span><span class="s1">levels_ess is:</span><span class="se">\n</span><span class="si">{</span><span class="n">levels_ess</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">software</span> <span class="o">=</span> <span class="s1">&#39;orca&#39;</span>

        <span class="c1"># Gaussian</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method_type</span> <span class="o">==</span> <span class="s1">&#39;composite&#39;</span> <span class="ow">or</span> <span class="n">job_type</span> <span class="o">==</span> <span class="s1">&#39;composite&#39;</span> <span class="ow">or</span> <span class="n">job_type</span> <span class="o">==</span> <span class="s1">&#39;irc&#39;</span> \
                <span class="ow">or</span> <span class="nb">any</span><span class="p">([</span><span class="nb">sum</span><span class="p">([</span><span class="s1">&#39;iop&#39;</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">subdict</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span> <span class="k">for</span> <span class="n">subdict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">values</span><span class="p">()]):</span>
            <span class="k">if</span> <span class="s1">&#39;gaussian&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">supported_ess</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Could not find Gaussian to run the </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="si">}</span><span class="s1">.</span><span class="se">\n</span><span class="s1">&#39;</span>
                                 <span class="sa">f</span><span class="s1">&#39;levels_ess is:</span><span class="se">\n</span><span class="si">{</span><span class="n">levels_ess</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">software</span> <span class="o">=</span> <span class="s1">&#39;gaussian&#39;</span>

        <span class="c1"># TorchANI</span>
        <span class="k">if</span> <span class="s1">&#39;torchani&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">software</span> <span class="o">=</span> <span class="s1">&#39;torchani&#39;</span>

        <span class="c1"># xTB</span>
        <span class="k">if</span> <span class="s1">&#39;xtb&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="ow">or</span> <span class="s1">&#39;gfn&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">software</span> <span class="o">=</span> <span class="s1">&#39;xtb&#39;</span>

        <span class="c1"># User phrases from settings (levels_ess)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">software</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ess</span><span class="p">,</span> <span class="n">phrase_list</span> <span class="ow">in</span> <span class="n">levels_ess</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">phrase</span> <span class="ow">in</span> <span class="n">phrase_list</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">software</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> \
                            <span class="p">(</span><span class="n">phrase</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">phrase</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">software</span> <span class="o">=</span> <span class="n">ess</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">software</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">preferred_ess_order</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;gaussian&#39;</span><span class="p">,</span> <span class="s1">&#39;qchem&#39;</span><span class="p">,</span> <span class="s1">&#39;orca&#39;</span><span class="p">,</span> <span class="s1">&#39;molpro&#39;</span><span class="p">,</span> <span class="s1">&#39;terachem&#39;</span><span class="p">,</span> <span class="s1">&#39;cfour&#39;</span><span class="p">]</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;force_field&#39;</span><span class="p">,</span> <span class="s1">&#39;semiempirical&#39;</span><span class="p">]:</span>
                <span class="n">preferred_ess_order</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;gaussian&#39;</span><span class="p">,</span> <span class="s1">&#39;qchem&#39;</span><span class="p">,</span> <span class="s1">&#39;orca&#39;</span><span class="p">,</span> <span class="s1">&#39;molpro&#39;</span><span class="p">,</span> <span class="s1">&#39;terachem&#39;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;wavefunction&#39;</span><span class="p">]:</span>
                <span class="n">preferred_ess_order</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;molpro&#39;</span><span class="p">,</span> <span class="s1">&#39;gaussian&#39;</span><span class="p">,</span> <span class="s1">&#39;orca&#39;</span><span class="p">,</span> <span class="s1">&#39;cfour&#39;</span><span class="p">,</span> <span class="s1">&#39;qchem&#39;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;composite&#39;</span><span class="p">]:</span>
                <span class="n">preferred_ess_order</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;gaussian&#39;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;dft&#39;</span><span class="p">]:</span>
                <span class="n">preferred_ess_order</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;gaussian&#39;</span><span class="p">,</span> <span class="s1">&#39;qchem&#39;</span><span class="p">,</span> <span class="s1">&#39;terachem&#39;</span><span class="p">,</span> <span class="s1">&#39;orca&#39;</span><span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">determine_compatible_ess</span><span class="p">()</span>
            <span class="n">relevant_software</span> <span class="o">=</span> <span class="n">get_ordered_intersection_of_two_lists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">compatible_ess</span><span class="p">,</span> <span class="n">supported_ess</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">software</span> <span class="o">=</span> <span class="n">get_ordered_intersection_of_two_lists</span><span class="p">(</span><span class="n">preferred_ess_order</span><span class="p">,</span> <span class="n">relevant_software</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> \
                <span class="k">if</span> <span class="n">relevant_software</span> <span class="k">else</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="Level.determine_compatible_ess"><a class="viewcode-back" href="../../api/level.html#arc.level.Level.determine_compatible_ess">[docs]</a>    <span class="k">def</span> <span class="nf">determine_compatible_ess</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine compatible ESS.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">compatible_ess</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Don&#39;t append if the user already specified a restricted list.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">compatible_ess</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="n">ess_methods</span> <span class="o">=</span> <span class="n">read_yaml_file</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ARC_PATH</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;ess_methods.yml&#39;</span><span class="p">))</span>
            <span class="n">ess_methods</span> <span class="o">=</span> <span class="p">{</span><span class="n">ess</span><span class="p">:</span> <span class="p">[</span><span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">]</span> <span class="k">for</span> <span class="n">ess</span><span class="p">,</span> <span class="n">methods</span> <span class="ow">in</span> <span class="n">ess_methods</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
            <span class="k">for</span> <span class="n">ess</span> <span class="ow">in</span> <span class="n">supported_ess</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ess</span> <span class="ow">in</span> <span class="n">ess_methods</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="ow">in</span> <span class="n">ess_methods</span><span class="p">[</span><span class="n">ess</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">compatible_ess</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ess</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="get_params_from_arkane_level_of_theory_as_str"><a class="viewcode-back" href="../../api/level.html#arc.level.get_params_from_arkane_level_of_theory_as_str">[docs]</a><span class="k">def</span> <span class="nf">get_params_from_arkane_level_of_theory_as_str</span><span class="p">(</span><span class="n">arkane_level</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the method, basis set, and software (if any) of an str representation of an Arkane LevelOfTheory object instance.</span>

<span class="sd">    Args:</span>
<span class="sd">        arkane_level (str): The Arkane level.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict[str, str]: Keys are &#39;method&#39;, &#39;basis&#39;, &#39;software&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># LevelOfTheory(method=&#39;b3lyp&#39;,basis=&#39;6311+g(3df,2p)&#39;,software=&#39;gaussian&#39;)</span>
    <span class="n">level_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;basis&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;software&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                  <span class="p">}</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">level_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">arkane_level</span><span class="p">:</span>
            <span class="n">splits</span> <span class="o">=</span> <span class="n">arkane_level</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">=&#39;&quot;</span><span class="p">)</span>
            <span class="n">level_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">splits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">level_dict</span></div>


<div class="viewcode-block" id="assign_frequency_scale_factor"><a class="viewcode-back" href="../../api/level.html#arc.level.assign_frequency_scale_factor">[docs]</a><span class="k">def</span> <span class="nf">assign_frequency_scale_factor</span><span class="p">(</span><span class="n">level</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Level</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Assign a frequency scaling factor to a level of theory.</span>

<span class="sd">    Args:</span>
<span class="sd">        level (Union[str, Level]): The level of theory.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Optional[int]: The frequency scaling factor.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">freq_scale_factors</span> <span class="o">=</span> <span class="n">read_yaml_file</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ARC_PATH</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;freq_scale_factors.yml&#39;</span><span class="p">))[</span><span class="s1">&#39;freq_scale_factors&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">level</span> <span class="ow">in</span> <span class="n">freq_scale_factors</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">freq_scale_factors</span><span class="p">[</span><span class="n">level</span><span class="p">]</span>
        <span class="n">level</span> <span class="o">=</span> <span class="n">Level</span><span class="p">(</span><span class="nb">repr</span><span class="o">=</span><span class="n">level</span><span class="p">)</span>
    <span class="n">level_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">level_str</span> <span class="ow">in</span> <span class="n">freq_scale_factors</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">freq_scale_factors</span><span class="p">[</span><span class="n">level_str</span><span class="p">]</span>
    <span class="k">return</span> <span class="kc">None</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018-2024, Alon Grinberg Dana

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>